@model CurrencySelectorModel
@using Nop.Web.Models.Common;
@using Nop.Core;
@using Nop.Core.Infrastructure;
@using Nop.Core.Infrastructure.DependencyManagement;
@if (Model.AvailableCurrencies.Count > 1)
{
    var webHelper = EngineContext.Current.Resolve<IWebHelper>();
    
    var currencies = Model.AvailableCurrencies.Select(x => new SelectListItem
        {
            Text = x.Name,
            Value = webHelper.ModifyQueryString(Url.RouteUrl("ChangeCurrency", new { customercurrency = x.Id }), "returnurl=" + HttpUtility.UrlEncode(HttpContext.Current.Request.RawUrl), null),
            Selected = x.Id.Equals(Model.CurrentCurrencyId)
        });
    
    @*@Html.DropDownList("customerCurrency", currencies, new { onchange = "setLocation(this.value);" })*@


    <div class="selector-dropdown">
        <div class="btn-group">
            <span>
                <div type="button" class="btn btn-sm">Currency : 
                    <span class="selected-val">
                        @foreach (var just_currency in currencies)
                        {
                            if(just_currency.Selected==true)
                            {
                                @just_currency.Text
                            }
                        }
                    </span>
                </div>
                <div class="btn btn-sm dropdown-toggle" data-toggle="dropdown">
                    <span class="caret"></span>
                </div>
            </span>
            <ul class="dropdown-menu box-dropdown-menu">
                @foreach (var currency in currencies)
                {
                    <li class="btn-sm"><a href="@currency.Value">@currency.Text</a></li>
                }
            </ul>
        </div>
    </div>
}